<div class="container100">
  <div class="row nopadding header basePadding">
    <div class="col-6 nopadding">
      <div class="backgroundLogo"></div>
    </div>
  </div>
  <div class="containerBox basePadding">
    <div class="flexContainer">
      <ngb-accordion #a="ngbAccordion" activeIds="custom-panel-1">
        <ngb-panel id="custom-panel-1">
          <ng-template ngbPanelHeader let-opened="opened">
            <div class="d-flex align-items-center justify-content-between">
              <h5 class="m-0">Summary</h5>
            </div>
          </ng-template>
          <ng-template ngbPanelContent>
            <div class="row nopadding dailySection">
              <div class="col-6 nopadding favouriteBox">
                <div class="row nopadding favoutireSection">
                  <ng-container *ngIf="favouriteList.length > 0">
                    <div class="col-12 nopadding favouriteTitle">
                      Favourites
                    </div>
                    <div class="col-12 nopadding favouriteBody">
                      <div class="row nopadding">
                        <div class="col-6 col-lg-4 nopadding favouriteBody">
                          <ul *ngFor="let fav of favouriteList; let i = index">
                            <li *ngIf="(i+3)%3 == 0">
                              {{fav}}
                            </li>
                          </ul>
                        </div>
                        <div class="col-6 col-lg-4 nopadding favouriteBody">
                          <ul *ngFor="let fav of favouriteList; let i = index">
                            <li *ngIf="(i+2)%3 == 0">
                              {{fav}}
                            </li>
                          </ul>
                        </div>
                        <div class="col-6 col-lg-4 nopadding favouriteBody">
                          <ul *ngFor="let fav of favouriteList; let i = index">
                            <li *ngIf="(i+1)%3 == 0">
                              {{fav}}
                            </li>
                          </ul>
                        </div>
                      </div>

                    </div>
                  </ng-container>
                  <ng-container *ngIf="favouriteList.length == 0">
                    <div class="noFavs">
                      <div class="noFavsCenter">
                        <div>
                          <i class="fa fa-frown-o noFavsIcon" aria-hidden="true"></i>
                        </div>
                        <div>
                          No favourites selected yet!
                        </div>

                      </div>
                    </div>
                  </ng-container>

                </div>
              </div>
              <div class="col-6 nopadding favouriteBox">
                <div class="row nopadding favoutireSection">
                  <ng-container *ngIf="!apiErrorTop">
                    <div class="col-12 nopadding favouriteTitle">
                      Top companies ({{today | date:'mediumDate'}}) 
                    </div>
                    <div class="col-12 nopadding favouriteBody tableBody">
                      <table class="table table-striped nopadding">
                        <thead>
                          <tr >
                            <th *ngFor="let item of topData" scope="col">{{item.symbol}}</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            <td *ngFor="let item of topData">{{item.price | number:'1.2-2'}} {{item.currency}}</td>
                          </tr>
                        </tbody>
                      </table>

                    </div>
                  </ng-container>
                  <ng-container *ngIf="apiErrorTop">
                    <div class="noFavs">
                      <div class="noFavsCenter">
                        <div>
                          <i class="fa fa-frown-o noFavsIcon" aria-hidden="true"></i>
                        </div>
                        <div>
                          Unable to retrieve top companies latest results
                        </div>

                      </div>
                    </div>
                  </ng-container>

                </div>
              </div>
            </div>
          </ng-template>
        </ngb-panel>
        <ngb-panel id="custom-panel-1">
          <ng-template ngbPanelHeader let-opened="opened">
            <div class="d-flex align-items-center justify-content-between">
              <h5 class="m-0">Historic search</h5>
            </div>
          </ng-template>
          <ng-template ngbPanelContent>
            <div class="row nopadding ">
              <div class="col-12 col-md-9 col-lg-3 inputIcon">
                <div class="iconInline">
                  <i class="fa fa-search iconFont" aria-hidden="true"></i>
                </div>
                <input type="text" class="form-control" [value]="inputSettings.value" [placeholder]="inputSettings.placeholder" (keyup)="checkValues($event)"
                  (focus)="checkValues($event)" (focusout)="checkValues($event)" />
              </div>
              <div class="col-6 col-lg-2">
                <div ngbDropdown class="d-inline-block">
                  <button class="btn btn-secondary" id="dropdownBasic1" ngbDropdownToggle>{{dropdownSettings.selectedItem.value}}</button>
                  <div ngbDropdownMenu aria-labelledby="dropdownBasic1" class="dropdownBody">
                    <button ngbDropdownItem disabled>Common</button>
                    <button ngbDropdownItem *ngFor="let itemC of dropdownSettings.commonList" (click)="setSelectedValue(itemC)">{{itemC.value}}</button>
                    <button ngbDropdownItem disabled>Full list</button>
                    <button ngbDropdownItem *ngFor="let item of dropdownSettings.list" (click)="setSelectedValue(item)">{{item.value}}</button>
                  </div>
                </div>
              </div>
              <div class="col-6 col-lg-2">
                <form class="form-inline">
                  <div class="form-group">
                    <div class="input-group">
                      <input class="form-control" [placement]="'bottom'" placeholder="Date" name="dp" [(ngModel)]="dateModel" ngbDatepicker #d="ngbDatepicker">
                      <div class="input-group-append">
                        <button class="btn btn-secondary calendar" (click)="d.toggle()" type="button">
                          <i class="fa fa-calendar" aria-hidden="true"></i>
                        </button>
                      </div>
                    </div>
                  </div>
                </form>
              </div>
              <div class="col-5 col-lg-5">
                <div class="row nopadding justify-content-end">
                  <div class="col-6 nopadding text-right">
                    <button class="btn btn-secondary" type="submit" (click)="submit()">Search</button>
                  </div>
                </div>
              </div>
              <div class="col-12 nopadding">
                <div class="errorMessage" *ngIf="errorMessages.invalidFields">Date and Currency are mandatory fields</div>
                <div class="errorMessage" *ngIf="errorMessages.invalidDate">Only past dates are valid</div>
              </div>
            </div>
            <div class="row nopadding tableSection minHeight">
              <table class="table table-striped nopadding">
                <thead>
                  <tr>
                    <th scope="col" class="fav">Fav.</th>
                    <th scope="col">Company</th>
                    <th scope="col">Open Value</th>
                    <th scope="col">Close Value</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let item of data">
                    <th scope="row" class="fav">
                      <i (click)="saveFavourite(item)" [ngClass]="{'gold': item.fav}" class="fa fa-star"></i>
                    </th>
                    <td>{{item.symbol}} - {{item.name}}</td>
                    <td>{{item.openConvert | number:'1.2-2'}} {{item.currencyConvert}}</td>
                    <td>{{item.closeConvert | number:'1.2-2'}} {{item.currencyConvert}}</td>
                  </tr>
                </tbody>
              </table>
              <ng-container *ngIf="apiErrorSearch">
                <div class="errorWS">
                  <div class="errorWSCenter">
                    <div>
                      <i class="fa fa-frown-o errorWSIcon" aria-hidden="true"></i>
                    </div>
                    <div>
                      Unable to retrieve information. Possible server error
                    </div>
                  </div>
                </div>
              </ng-container>
            </div>
          </ng-template>
        </ngb-panel>
      </ngb-accordion>
    </div>
  </div>
</div>

<app-loading *ngIf="loadingData"></app-loading>